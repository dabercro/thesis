\chapter{Analysis Results} \label{ch:results}

\section{Run 2 Data Collection}

The CMS detector collected proton-proton collision data at $\sqrt{s} = \SI{13}{TeV}$
over three years during Run 2 of the LHC.
In 2016, CMS collected \SI{35.9}{fb^{-1}} of data \cite{CMS-PAS-LUM-17-001}.
In 2017, \SI{41.5}{fb^{-1}} of data was collected \cite{CMS-PAS-LUM-17-004}.
In 2018, CMS collected \SI{60}{fb^{-1}} of collision data \cite{CMS-PAS-LUM-18-002}.
This data was used for the analysis.

\section{Control Region Plots}

A number of variables are compared in all of the control regions
to ensure that the data and simulation are in reasonable agreement.
A selection of these plots are shown in Figures~\ref{fig:2016_Zll_vpt} through \ref{fig:2018_Zmm_vpt}.
%,fig:2016_Wln_j0pt,fig:2017_Znn_j0csv,fig:2017_Zee_j1pt,fig:2018_Wln_j1csv,
These are pre-fit distributions, so agreements improve after fitting the Monte Carlo to the gathered data.
The number of variables, selections, and separation of the data collection years
means that this is just a fraction of the total number of plots produced.
However, this subset shown demonstrate several discrepancies that needed to be accounted for in our systematics,
such as the $p_T(V)$ trend and normalization of certain background samples.

\begin{figure}
  \centering
  \includegraphics[width=0.42\linewidth]{figures/2016_Zll/ttbar_low_Zll__kinFit_V_pt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2016_Zll/ttbar_med_Zll__kinFit_V_pt_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2016_Zll/Zhf_low_Zll__kinFit_V_pt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2016_Zll/Zhf_med_Zll__kinFit_V_pt_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2016_Zll/Zlf_low_Zll__kinFit_V_pt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2016_Zll/Zlf_med_Zll__kinFit_V_pt_.pdf}
  \caption[Control region plots for two leptons in 2016]{
    The vector boson $p_T$ is plotted for multiple control regions and bins in
    an inclusive selection of both the $Z\rightarrow \mu\mu$ and $Z\rightarrow ee$
    two lepton channels with 2016 data.
    The top row shows the $t\bar{t}$ control region,
    the middle row shows the $Z$+ heavy jets,
    and the bottom row shows the $Z$+ light jets control region.
    The left column shows the low $p_T(V)$ bin of 75 to \SI{150}{GeV},
    and the right column shows the medium $p_T(V)$ bin of 150 to \SI{250}{GeV}.
  }
  \label{fig:2016_Zll_vpt}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.42\linewidth]{figures/2016_Wln/ttbar_med_Wln__Hj0_pt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2016_Wln/ttbar_high_Wln__Hj0_pt_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2016_Wln/Whf_med_Wln__Hj0_pt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2016_Wln/Whf_high_Wln__Hj0_pt_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2016_Wln/Wlf_med_Wln__Hj0_pt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2016_Wln/Wlf_high_Wln__Hj0_pt_.pdf}
  \caption[Control region plots for one lepton in 2016]{
    The $p_T$ of the jet with a higher DeepCSV value
    is plotted for multiple control regions and bins in
    an inclusive selection of both the $W\rightarrow \mu\nu$ and $W\rightarrow e\nu$
    one lepton channels with 2016 data.
    The top row shows the $t\bar{t}$ control region,
    the middle row shows the $W$+ heavy jets,
    and the bottom row shows the $W$+ light jets control region.
    The left column shows the medium $p_T(V)$ bin of 150 to \SI{250}{GeV},
    and the right column shows the high $p_T(V)$ bin of \SI{250}{GeV} and above.
  }
  \label{fig:2016_Wln_j0pt}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.42\linewidth]{figures/2017_Znn/ttbar_med_Znn__Hj0_DeepCSV_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2017_Znn/ttbar_high_Znn__Hj0_DeepCSV_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2017_Znn/Zhf_med_Znn__Hj0_DeepCSV_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2017_Znn/Zhf_high_Znn__Hj0_DeepCSV_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2017_Znn/Zlf_med_Znn__Hj0_DeepCSV_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2017_Znn/Zlf_high_Znn__Hj0_DeepCSV_.pdf}
  \caption[Control region plots for zero lepton in 2017]{
    The DeepCSV value of the jet with a higher DeepCSV value
    is plotted for multiple control regions and bins in
    an inclusive selection of both the $Z\rightarrow \mu\nu$ and $Z\rightarrow e\nu$
    one lepton channels with 2017 data.
    The top row shows the $t\bar{t}$ control region,
    the middle row shows the $Z$+ heavy jets,
    and the bottom row shows the $Z$+ light jets control region.
    The left column shows the medium $p_T(V)$ bin of 150 to \SI{250}{GeV},
    and the right column shows the high $p_T(V)$ bin of \SI{250}{GeV} and above.
  }
  \label{fig:2017_Znn_j0csv}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.42\linewidth]{figures/2017_Zee/ttbar_low_Zee__Hj1_pt_reg_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2017_Zee/ttbar_med_Zee__Hj1_pt_reg_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2017_Zee/Zhf_low_Zee__Hj1_pt_reg_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2017_Zee/Zhf_med_Zee__Hj1_pt_reg_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2017_Zee/Zlf_low_Zee__Hj1_pt_reg_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2017_Zee/Zlf_med_Zee__Hj1_pt_reg_.pdf}
  \caption[Control region plots for two electrons in 2017]{
    The $p_T$ of the jet with a lower DeepCSV score is plotted for
    multiple control regions and bins in
    the $Z\rightarrow ee$ two lepton channel with 2017 data.
    The top row shows the $t\bar{t}$ control region,
    the middle row shows the $Z$+ heavy jets,
    and the bottom row shows the $Z$+ light jets control region.
    The left column shows the low $p_T(V)$ bin of 75 to \SI{150}{GeV},
    and the right column shows the medium $p_T(V)$ bin of 150 to \SI{250}{GeV}.
  }
  \label{fig:2017_Zee_j1pt}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.42\linewidth]{figures/2018_Wln/ttbar_medhigh_Wen__Hj1_DeepCSV_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2018_Wln/ttbar_medhigh_Wmn__Hj1_DeepCSV_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2018_Wln/Whf_medhigh_Wen__Hj1_DeepCSV_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2018_Wln/Whf_medhigh_Wmn__Hj1_DeepCSV_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2018_Wln/Wlf_medhigh_Wen__Hj1_DeepCSV_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2018_Wln/Wlf_medhigh_Wmn__Hj1_DeepCSV_.pdf}
  \caption[Control region plots for one lepton in 2018]{
    The DeepCSV value of the jet with a higher DeepCSV value
    is plotted for multiple control regions in
    an inclusive selection that contains all STXS bins with
    $p_T(V)$ greater than \SI{150}{GeV}
    in the one lepton channels with 2018 data.
    The top row shows the $t\bar{t}$ control region,
    the middle row shows the $W$+ heavy jets,
    and the bottom row shows the $W$+ light jets control region.
    The left column shows the  $W\rightarrow e\nu$ channel,
    and the right column shows the $W\rightarrow \mu\nu$ channel.
  }
  \label{fig:2018_Wln_j1csv}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.42\linewidth]{figures/2018_Zmm/ttbar_low_Zmm__Vpt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2018_Zmm/ttbar_medhigh_Zmm__Vpt_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2018_Zmm/Zhf_low_Zmm__Vpt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2018_Zmm/Zhf_medhigh_Zmm__Vpt_.pdf}
  \includegraphics[width=0.42\linewidth]{figures/2018_Zmm/Zlf_low_Zmm__Vpt_.pdf} ~
  \includegraphics[width=0.42\linewidth]{figures/2018_Zmm/Zlf_medhigh_Zmm__Vpt_.pdf}
  \caption[Control region plots for two muons in 2018]{
    The vector boson $p_T$ is plotted for multiple control regions and bins in
    the $Z\rightarrow \mu\mu$ two lepton channel with 2018 data.
    The top row shows the $t\bar{t}$ control region,
    the middle row shows the $Z$+ heavy jets,
    and the bottom row shows the $Z$+ light jets control region.
    The left column shows the low $p_T(V)$ bin of 75 to \SI{150}{GeV},
    and the right column shows an inclusive selection of
    the medium and high $p_T(V)$ bins of greater than \SI{150}{GeV}.
  }
  \label{fig:2018_Zmm_vpt}
\end{figure}

\section{Multivariate Discriminator}

In each STXS bin, a multivariate discriminator is plotted which separates
the signal events from background events.
A Deep Neural Network (DNN) is trained for the resolved selection,
and a Boosted Decision Tree (BDT) is trained for the boosted selection.
Using fewer discriminating variables in the boosted events
leads to this difference in architecture.

\subsection{Resolved DNN}

The DNN classifier for distinguishing background and signal events is prepared using
Keras with a Tensorflow backend using an Adam optimizer.
It has five hidden layers.
The number of nodes in each layer, from input to output, is 512, 256, 128, 64, 64, and 64.
The final layer is a softmax layer with the target of predicting the probability
of each event belonging to a particular class.

Each channel of 0-, 1-, and 2-leptons is trained separately,
and has slightly different input variables.
The list of input variables is given in Table~\ref{tab:dnn-inputs}.
All variables that are affected by the kinematic fit in the 2-lepton region
use the values calculated by the fit.

\begin{table}
  \caption[Resolved DNN inputs]{
    The list of input variables used for each DNN training is shown.
  }
  \centering
  \begin{tabularx}{\textwidth}{|l|X|c|c|c|}
    \hline
    Variable & Explanation & 0-lepton & 1-lepton & 2-lepton \\
    \hline\hline
    $m_{jj}$ & Di-jet mass & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    $p_{T,jj}$ & Di-jet transverse momentum & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    MET & Missing transverse energy & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    \hline
    $m_{T,V}$ & Vector boson transverse mass & & $\checkmark$ & \\
    $p_T(V)$ & Vector boson $p_T$ & & $\checkmark$ & $\checkmark$ \\
    $p_{T,jj}/p_T(V)$ & Redundant ratio & & $\checkmark$ & $\checkmark$ \\
    \hline
    $\Delta\phi(V, jj)$ & Azimuthal angle between vector boson and di-jet & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    $b$-tag$_\mathrm{max}$ WP & 1, 2, or 3 if higher $b$-tag discriminate meets the tight, medium, or loose working point respectively & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    $b$-tag$_\mathrm{min}$ WP & 1, 2, or 3 if lower $b$-tag discriminate meets the tight, medium, or loose working point respectively & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    \hline
    $\Delta\eta(jj)$ & $\eta$ difference between jets & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    $\Delta\phi(jj)$ & Azimuthal angle between jets & $\checkmark$ & $\checkmark$ & \\
    $p_{T, \mathrm{lead}}$ & Leading jet $p_T$ & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    \hline
    $p_{T, \mathrm{trail}}$ & Trailing jet $p_T$ & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    SA5 & Number of soft jets, $p_T > \SI{5}{GeV}$ & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
    N_{aj} & Number of additional jets & $\checkmark$ & $\checkmark$ & \\
    \hline
    $b$-tag$_\mathrm{add}$ & Maximum $b$-tag of additional jets & $\checkmark$ & & \\
    $p_{T,\mathrm{add}}$ & Maximum $p_T$ of additional jets & $\checkmark$ & & \\
    $\Delta\phi(\mathrm{add, MET})$ & Azimuthal angle between additional jet and MET & $\checkmark$ & & \\
    \hline
    $\Delta\phi(\ell, \mathrm{MET})$ & Azimuthal angle between lepton and MET & & $\checkmark$ & \\
    $m_t$ & Reconstruction top mass & & $\checkmark$ & \\
    $m_V$ & Vector boson mass & & & $\checkmark$ \\
    \hline
    $\Delta R(V, jj)$ & Separation between vector boson and di-jet & & & $\checkmark$ \\
    $\Delta R_{jj}$ & Separation between jets & & & $\checkmark$ \\
    \hline
  \end{tabularx}
  \label{tab:dnn-inputs}
\end{table}

\subsection{Boosted BDT}

The BDT used to classify signal and background events in the boosted region
was trained using ROOT.
The model uses 100 trees with 20 cuts and a minimum node size of 0.05.
The QCD multi-jet backgrounds were not used in the training since the sample's large weights
of individual events affected the training.

The list of input variables for the BDT is the following:
\begin{itemize}
\item Soft-drop mass of the reconstructed fat jet
\item Transverse momentum of the fat jet
\item Transverse momentum of the reconstructed vector boson
\item Number of soft-track jets with $p_T > \SI{5}{GeV}$
\item Double $b$-tagger output node for boosted jets
\end{itemize}
All of these variables were all used in the 0-, 1-, and 2-lepton regions,
even though the regions were trained separately.

\section{Combination Fit}

A simultaneous fit is run over all channels, control regions, and the signal selection region
in order to determine the most likely values for all
parameters with systematic uncertainties, called nuisance parameters,
as well as the most likely scale factors for all the MC backgrounds and signal.
The fit is done by using the \texttt{combine} tool \cite{cmsdocumentation} as part of
\texttt{CMSSW\_10\_2\_13} \cite{cmssw_doxygen}.
Part of the method for discovery involves finding the most likely values
for all nuisance parameters and signal strength simultaneously.
This maximum likelihood feature is used for the measurement of signal strength in
the STXS bins.
The difference in signal strength uncertainty when allowing the nuisance parameters to float
from their most likely values or not show the overall effect of the systematic uncertainties
on the final measurement.

In addition, \texttt{combine} includes a variety of diagnostic tools to ensure
the assumed model is adequate.
The first step before unblinding results is to throw toys using the best-fit
nuisance parameter values and comparing a test statistic of these toys to that of the observed data.
Comparing the observed value to the toy distribution will give a p-value
of the post-fit simulation yielding the observed value.
The \texttt{combine} tool can also evaluate the impacts of each individual
nuisance parameter on the likelihood by varying them individually.
If nuisance parameters with large impacts are pulled far from their initial value,
that means that an important aspect of the measurement was not well understood.

The final results will therefore show comparison of data and best-fit toys,
called Goodness of Fit, as well as the final scan results.
A post-fit plots will also reveal the way that the fit moves the background and signal distributions
within uncertainties in order for the background to describe the data.
Impacts plots are shown in Appendix~\ref{app:impacts} due to the high multiplicity of nuisance parameters.
Before running these checks and measurements for the $V\!H$ measurement,
they were first tested on $V\!Z$.

\subsection{$V\!Z$ Cross Check Analysis}

The $V\!Z$ cross check analysis duplicated the $V\!H$, including having its own dedicated DNN training.
The primary differences are that a di-boson sample with generator-level $b$ hadrons produced
is used as the signal sample, and the signal mass window is moved from $\SI{90}{GeV} < m_{jj} < \SI{150}{GeV}$
to  $\SI{60}{GeV} < m_{jj} < \SI{120}{GeV}$.
Data from all three years of Run 2 are used again so that any differences that may affect the $V\!H$ analysis
can also be investigated using $V\!Z$.

The Goodness of Fit plots are shown in Figure~\ref{fig:vz-gof}.
The high p-value means that the simulated processes were able to match the data very well
while staying within the fit constraints of the systematic uncertainties.
%
\begin{figure}
  \centering
  \includegraphics[width=0.8\linewidth]{figures/210211_STXS_VZ_XbbVZ_decorr12345_skip_513dc9b8_inclusive_gof/Gof_inclusive_.pdf}
  \caption[Goodness of Fit for $V\!Z$]{
    The Goodness of Fit test results are shown for $V\!Z$.
    The fit is performed using STXS bins,
    and the test statistic is generated by toys for all control regions and signal regions.
  }
  \label{fig:vz-gof}
\end{figure}
%

\begin{figure}
  \centering
  \includegraphics[width=0.8\linewidth]{figures/201118_inclVZ/scan_nominal_r.pdf}
  \caption[Inclusive likelihood scan of $V\!Z$]{
    The likelihood scan of the inclusive signal strength of the
    $V\!Z$ cross check analysis.
  }
  \label{fig:vz-inclusive}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.8\linewidth]{figures/201118_STXS_VZ/summary_stxs.pdf}
  \caption[Measured STXS values of $V\!Z$]{
    The measured most likely values of all STXS bins in the
    $V\!Z$ cross check analysis.
  }
  \label{fig:vz_stxs}
\end{figure}
